<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test website</title>
</head>
<body>
    <h1>This is my website!</h1>

    </p>
    Lorem ipsum dolor sit amet consectetur adipisicing elit. Accusamus quas repudiandae exercitationem eius minima quibusdam ab incidunt, nemo totam sed doloribus atque, non possimus. Cum dicta autem officia officiis magni.
    </p>

    <p>
    Lorem ipsum dolor sit amet consectetur adipisicing elit. Ullam cumque dolorum mollitia.
    </p>
    
    <p>
    Lorem ipsum dolor sit amet consectetur adipisicing elit. Quibusdam veritatis ratione ad, maiores sit labore voluptas voluptates aperiam laboriosam quam.
    </p>

    <img src="aa.png" alt="aa image" height="200px">
    <img src="sneaker1.png" alt="aa image" height="300px">

    <br>
    <br>
    <br>

    <div>
        <canvas id="myChart"></canvas>
    </div>
</body>
<script src="./chart.js"></script>
<script src="./all_sales.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

      
<script>

  const ctx = document.getElementById('myChart');
  var sale_dates = all_sales.map(item => new Date(`${item[0]} ${item[1]}`));

  var aggregatedData = all_sales.reduce((acc, sale) => {
    var date = new Date(`${sale[0]} ${sale[1]}`);
    var size = sale[2];
    var price = parseFloat(sale[3].slice(1));

    if (!acc[size]) {
      acc[size] = {
        prices: [price],
        dates: [date]
      };
    } else {
      acc[size].prices.push(price);
      acc[size].dates.push(date);
    }

    return acc;
  }, {});

  console.log(aggregatedData);

  var colors = [
    "#ff6384",
    "#36a2eb",
    "#ffce56",
    "#4bc0c0",
    "#9966ff"
  ];
  var datasets = Object.keys(aggregatedData).map((size, i) => ({
    label: `Shoe size: ${size}`,
    backgroundColor: colors[i],
    borderColor: colors[i],
    data: aggregatedData[size].prices,
    xAxisID: "x-axis-0",
    yAxisID: "y-axis-0",
    fill: false
  }));

  console.log(datasets);



  new Chart(ctx, {
    type: 'line',
    data: {
      datasets: datasets,
      labels: sale_dates,
      // labels: sale_dates,

      //   [
      //       sale_dates[0],
      //       sale_dates[Math.floor(sale_dates.length / 4)],
      //       sale_dates[Math.floor(sale_dates.length / 2)],
      //       sale_dates[Math.floor(sale_dates.length * 3 / 4)],
      //       sale_dates[sale_dates.length - 1], 
      // ],

      // datasets: [{
      //   label: 'Shoe price',
      //   data: all_sales.map(x => parseInt(x[3].slice(1))),
      //   borderWidth: 3
      // }]
    },
    options: {
        scales: {
            xAxes: [{
                type: 'time',
                time: {
                    unit: 'second',
                    parser: 'MM/DD/YYYY',
                },
                ticks: {
                    maxTicksLimit: 5,
                },
            }],
        }
    }
  });
</script>
</html>